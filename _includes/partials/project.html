{% if page.url contains '/amp/' %}
<div id="project" class="ampstart-card m1">
    <main>
        <div class="heading">
            <h1>Project | {{ page.title }}</h1>
            {% assign words = content | number_of_words %}
            <p><small>
                {{ page.date | date_to_long_string }} • {% include reading_time.html %}

                <!-- Github link -->
                {% if page.github_link != nil and page.github_link != "" %}
                •
                <i class="fa fa-github"></i>
                <a href="{{ page.github_link }}">Github</a>
                {% endif %}

                <!-- Project tags -->
                {% if page.tags.size > 0 %}
                •
                <i class="fa fa-tags"></i>
                <strong>Tags:</strong>

                {% comment %}We print the first tag, then print any remainders with a comma between them{% endcomment %}
                {% for tag in page.tags limit:1 %}
                <a href="/blog?search={{ tag | slugify }}">{{ tag }}</a>
                {% endfor %}

                {% for tag in page.tags offset:1 %}, <a href="/blog?search={{ tag | slugify }}">{{ tag }}</a>{% endfor %}
                {% endif %}
            </small>
            </p>
            {% include amp/social_sharing.html %}
        </div>

        {{ page.content }}

        <!-- Related content -->
            {% comment %}---> initialize that there is a post{% endcomment %}
            {% assign is_first_post = true %}

            {% comment %}---> the maximum number of related to posts to be printed {% endcomment %}
            {% assign max_related = 5 %}

            {% comment %}---> the minimum number of common tags to have for a post to be considered as a related post {% endcomment %}
            {% assign min_common_tags =  3 %}

            {% assign max_related_counter = 0 %}

            {% for post in site.amp_projects %}

                {% assign same_tag_count = 0 %}
                {% assign common_tags = '' %}

                {% for tag in post.tags %}
                    {% comment %}---> Only compare if post is not same as current page {% endcomment %}
                    {% if post.url != page.url %}

                        {% if page.tags contains tag %}
                            {% assign same_tag_count = same_tag_count | plus: 1 %}
                            {% capture tagmarkup %} <span class="label label-default">{{ tag }}</span> {% endcapture %}
                            {% assign common_tags = common_tags | append: tagmarkup %}
                        {% endif %}
                    {% endif %}
                {% endfor %}

                {% if same_tag_count >= min_common_tags %}
                    {% if is_first_post == true %}
                        <h1>Related Content</h1>
                        <div class="related-content">
                        {% assign is_first_post = false %}
                    {% endif %}

                    <a class="card related" href="{{ site.baseurl }}{{ post.url }}" target="_top" role="listitem">
                        {% responsive_image_block %}
                            path: {{ post.image.name | prepend: 'assets/img/projects/' }}
                            alt: {{ post.image.alt_text }}
                            template: _includes/image-templates/amp_thumbnail.html
                        {% endresponsive_image_block %}

                        <span>{{ post.title }}</span>
                    </a>
                    {% assign max_related_counter = max_related_counter | plus: 1 %}
                    {% if max_related_counter >= max_related %}
                        {% break %}
                    {% endif %}
                {% endif %}
            {% endfor %}

            {% comment %}---> Puts in the closing tag for the div if the section is there {% endcomment %}
            {% if is_first_post == false %}</div> <!-- End related -->{% endif %}
    </main>

    <!-- Disqus comments -->
    <h1>Disqus Comments</h1>
    {% include amp/disqus.html %}
</div>

{% else %}

<!-- CONTENT -->
<div class="wrapper">
    <!--=== Container Part ===-->
    <div class="container">
        <div class="content">
            <h1 class="title-v1">Project | {{ page.title }}</h1>

            <!-- Project Information -->
            <div class="row margin-bottom-60">
                <!-- Project Description -->
                <div class="col-sm-8">
                    <div class="headline"><h2>Project Description</h2></div>
                    <p>
                        {{ page.content }}
                    </p>
                </div>

                <!-- Project Details -->
                <div class="col-sm-4">
                    <div class="headline"><h2>Project Details</h2></div>
                    <ul class="list-unstyled project-details">

                        <!-- Github link -->
                        {% if page.github_link != nil and page.github_link != "" %}
                        <li>
                            <i class="fa fa-github"></i>
                            <strong>Github:</strong>
                            <a href="{{ page.github_link }}">{{ page.github_link }}</a>
                        </li>
                        {% endif %}

                        <!-- Date project is posted -->
                        <li>
                            <i class="fa fa-clock-o"></i>
                            <strong>Date:</strong>
                            {% assign day = page.date | date: "%-d"  %}
                            {% case day %}
                            {% when '1' or '21' or '31' %}{{ day }}st
                            {% when '2' or '22' %}{{ day }}nd
                            {% when '3' or '23' %}{{ day }}rd
                            {% else %}{{ day }}th
                            {% endcase %}
                            {{ page.date | date: "of %B, %Y" }}
                        </li>

                        <!-- Project tags -->
                        <li>
                            <i class="fa fa-tags"></i>
                            <strong>Tags:</strong>
                            {% for tag in page.tags limit:1 %}<a href="/blog?search={{ tag | slugify }}">{{ tag }}</a>{% endfor %}{% for tag in page.tags offset:1 %}, <a href="/blog?search={{ tag | slugify }}">{{ tag }}</a>{% endfor %}
                        </li>

                    </ul>
                </div>
            </div>
            <!-- End Project Information -->
        </div>
    </div>
    <!--=== End Container Part ===-->

    <!-- Footer -->
    <div class="copyright-section"><p>{% include copyright.html %}</p></div>
</div><!--/wrapper-->
<!-- /CONTENT -->



{% endif %}

